<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ãƒ©ãƒ³ãƒ€ãƒ ã‚«ãƒ—ã‚²ãƒ¼ãƒ </title>
<style>
    :root {
        --bg: #f8f9fa;
        --card-bg: #ffffff;
        --border: #dee2e6;
        --text: #212529;
        --accent: #000000;
        --secondary: #f1f3f5;
        --muted: #6c757d;
        --focus: #000000;
    }

    body {
        font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
        background: var(--bg);
        color: var(--text);
        padding: 60px 20px;
        line-height: 1.8;
        max-width: 1000px;
        margin: 0 auto;
    }

    h1 { 
        text-align: center; 
        margin-bottom: 60px; 
        font-size: 48px; /* ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã‚ˆã‚Šå¤§ãã */
        font-weight: 800;
        letter-spacing: 0.1em;
    }

    h2, h3 {
        font-weight: 700;
        letter-spacing: 0.02em;
        margin-bottom: 20px;
    }

    .btn-group { text-align: center; margin-bottom: 40px; }

    /* ãƒ¡ã‚¤ãƒ³ãƒœã‚¿ãƒ³ï¼ˆä¿å­˜ãƒ»ã‚³ãƒ”ãƒ¼ãƒ»ã™ã¹ã¦æ±ºå®šï¼‰ */
    .primary-btn {
        background: var(--accent);
        color: white;
        border: 1px solid var(--accent);
        padding: 16px 32px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 18px;
        font-weight: 700;
        transition: all 0.2s ease;
        margin: 8px;
    }
    .primary-btn:hover { opacity: 0.8; transform: translateY(-2px); }

    /* æŠ½é¸ãƒœã‚¿ãƒ³ï¼ˆå¼•ããƒ»å‰Šé™¤ï¼‰ */
    .roll-btn {
        background: white;
        color: var(--text);
        border: 1px solid var(--border);
        padding: 6px 14px;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
        margin-left: auto;
    }
    .roll-btn:hover { background: var(--secondary); border-color: var(--muted); }

    /* ï¼‹è³ªå•ãƒ»ï¼‹å‡ºæ¥äº‹ãƒœã‚¿ãƒ³ */
    .add-btn {
        display: block;
        width: 100%;
        background: var(--secondary);
        color: var(--text);
        border: 2px dashed var(--border);
        padding: 15px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 20px;
        transition: 0.2s;
    }
    .add-btn:hover { background: #e9ecef; border-color: var(--muted); }

    .row {
        display: flex;
        gap: 30px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .card {
        flex: 1;
        min-width: 320px;
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.03);
    }

    .card h2 {
        font-size: 22px;
        border-left: 5px solid var(--accent);
        padding-left: 15px;
        margin-bottom: 30px;
    }

    .result-box {
        margin-bottom: 18px;
        padding-bottom: 14px;
        border-bottom: 1px solid var(--secondary);
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .result-label { 
        font-size: 13px; 
        color: var(--muted); 
        width: 100px;
        flex-shrink: 0;
    }

    .result-val { 
        font-weight: 700; 
        font-size: 18px; 
        flex-grow: 1;
    }

    select, textarea {
        width: 100%;
        box-sizing: border-box;
        padding: 12px;
        border: 1px solid var(--border);
        border-radius: 6px;
        font-size: 16px;
        background: #fff;
        transition: border-color 0.2s;
        font-family: inherit;
    }

    textarea:focus {
        outline: none;
        border-color: var(--focus);
        background: #fff;
    }

    textarea {
        overflow: hidden;
        resize: none;
        min-height: 48px;
        display: block;
    }

    .section {
        margin-top: 60px;
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 40px;
    }

    .section h2 { font-size: 26px; margin-bottom: 30px; border-bottom: 2px solid var(--accent); padding-bottom: 10px; display: inline-block; }

    .item-box {
        background: var(--bg);
        padding: 25px;
        border-radius: 10px;
        margin-bottom: 20px;
        position: relative;
        border: 1px solid var(--border);
    }

    .detail-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
    }

    .detail-title {
        font-weight: 700;
        font-size: 14px;
        margin-top: 20px;
        margin-bottom: 6px;
        display: block;
        color: var(--muted);
        letter-spacing: 0.05em;
    }

    /* è¨­å®šã‚¨ãƒªã‚¢ */
    .master-data {
        margin-top: 120px;
        padding: 40px;
        background: #eee;
        font-size: 13px;
        border-radius: 12px;
    }
    .master-data textarea {
        font-size: 13px;
        min-height: 100px;
        resize: vertical;
        overflow-y: auto;
    }

    @media (max-width: 768px) {
        .detail-grid { grid-template-columns: 1fr; }
        .row { flex-direction: column; }
        h1 { font-size: 32px; }
    }
</style>
</head>
<body>

<h1>ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ã‚«ãƒ—ã‚²ãƒ¼ãƒ </h1>

<div class="btn-group">
    <button class="primary-btn" onclick="rollAll()" style="font-size: 24px; padding: 20px 60px;">ã™ã¹ã¦ãƒ©ãƒ³ãƒ€ãƒ ã«æ±ºå®š</button>
</div>

<div class="row">
    <div class="card">
        <h2>CHARACTER 1</h2>
        <div class="result-box">
            <span class="result-label">æ€§åˆ¥</span>
            <select id="gender1">
                <option value="ç”·æ€§">ç”·æ€§</option>
                <option value="å¥³æ€§">å¥³æ€§</option>
                <option value="ä¸­æ€§">ä¸­æ€§</option>
            </select>
        </div>
        <div class="result-box">
            <span class="result-label">å±æ€§</span>
            <div class="result-val" id="attr1">-</div>
            <button class="roll-btn" onclick="rollGenderAttr(1)">å¼•ã</button>
        </div>
        <div class="result-box">
            <span class="result-label">è‚©æ›¸ã</span>
            <div class="result-val" id="title1">-</div>
            <button class="roll-btn" onclick="slot('title1', masterData.title)">å¼•ã</button>
        </div>
        <div class="result-box">
            <span class="result-label">ç›¸æ‰‹ã¸ã®æƒ³ã„</span>
            <div class="result-val" id="feel1">-</div>
            <button class="roll-btn" onclick="slot('feel1', masterData.feel)">å¼•ã</button>
        </div>
        <textarea class="save-target auto-resize" data-label="C1ãƒ¡ãƒ¢" placeholder="è‡ªç”±ãƒ¡ãƒ¢" style="margin-top:20px;"></textarea>
    </div>

    <div class="card">
        <h2>CHARACTER 2</h2>
        <div class="result-box">
            <span class="result-label">æ€§åˆ¥</span>
            <select id="gender2">
                <option value="ç”·æ€§">ç”·æ€§</option>
                <option value="å¥³æ€§">å¥³æ€§</option>
                <option value="ä¸­æ€§">ä¸­æ€§</option>
            </select>
        </div>
        <div class="result-box">
            <span class="result-label">å±æ€§</span>
            <div class="result-val" id="attr2">-</div>
            <button class="roll-btn" onclick="rollGenderAttr(2)">å¼•ã</button>
        </div>
        <div class="result-box">
            <span class="result-label">è‚©æ›¸ã</span>
            <div class="result-val" id="title2">-</div>
            <button class="roll-btn" onclick="slot('title2', masterData.title)">å¼•ã</button>
        </div>
        <div class="result-box">
            <span class="result-label">ç›¸æ‰‹ã¸ã®æƒ³ã„</span>
            <div class="result-val" id="feel2">-</div>
            <button class="roll-btn" onclick="slot('feel2', masterData.feel)">å¼•ã</button>
        </div>
        <textarea class="save-target auto-resize" data-label="C2ãƒ¡ãƒ¢" placeholder="è‡ªç”±ãƒ¡ãƒ¢" style="margin-top:20px;"></textarea>
    </div>
</div>

<div class="section">
    <h2>äºŒäººã®é–¢ä¿‚æ€§</h2>
    <div id="relation-container">
        <textarea class="save-target auto-resize" data-label="äºŒäººã®é–¢ä¿‚æ€§" placeholder=""></textarea>
    </div>
</div>

<div class="section">
    <h2>æ·±æ˜ã‚Šè³ªå•</h2>
    <div id="deep-container"></div>
    <button class="add-btn" onclick="addExtra('deep')">ï¼‹ è³ªå•ã‚’å¼•ã</button>
</div>

<div class="section">
    <h2>å‡ºæ¥äº‹</h2>
    <div id="event-container"></div>
    <button class="add-btn" onclick="addExtra('event')">ï¼‹ å‡ºæ¥äº‹ã‚’å¼•ã</button>
</div>

<div class="section">
    <h2>ç´°ã‹ã„è¨­å®š</h2>
    <div class="detail-grid">
        <div>
            <h3>CHARACTER 1</h3>
            <span class="detail-title">åå‰</span><textarea class="save-target auto-resize" data-label="C1åå‰"></textarea>
            <span class="detail-title">ä¸€äººç§°</span><textarea class="save-target auto-resize" data-label="C1ä¸€äººç§°"></textarea>
            <span class="detail-title">äºŒäººç§°</span><textarea class="save-target auto-resize" data-label="C1äºŒäººç§°"></textarea>
            <span class="detail-title">ç›¸æ‰‹ã‹ã‚‰ã®å‘¼ã°ã‚Œæ–¹</span><textarea class="save-target auto-resize" data-label="C1è¢«å‘¼ç§°"></textarea>
            <span class="detail-title">è¦‹ãŸç›®</span><textarea class="save-target auto-resize" data-label="C1å¤–è¦‹"></textarea>
            <span class="detail-title">å£èª¿</span><textarea class="save-target auto-resize" data-label="C1å£èª¿"></textarea>
        </div>
        <div>
            <h3>CHARACTER 2</h3>
            <span class="detail-title">åå‰</span><textarea class="save-target auto-resize" data-label="C2åå‰"></textarea>
            <span class="detail-title">ä¸€äººç§°</span><textarea class="save-target auto-resize" data-label="C2ä¸€äººç§°"></textarea>
            <span class="detail-title">äºŒäººç§°</span><textarea class="save-target auto-resize" data-label="C2äºŒäººç§°"></textarea>
            <span class="detail-title">ç›¸æ‰‹ã‹ã‚‰ã®å‘¼ã°ã‚Œæ–¹</span><textarea class="save-target auto-resize" data-label="C2è¢«å‘¼ç§°"></textarea>
            <span class="detail-title">è¦‹ãŸç›®</span><textarea class="save-target auto-resize" data-label="C2å¤–è¦‹"></textarea>
            <span class="detail-title">å£èª¿</span><textarea class="save-target auto-resize" data-label="C2å£èª¿"></textarea>
        </div>
    </div>
</div>

<div class="btn-group" style="margin-top: 100px;">
    <button class="primary-btn" onclick="saveText()">ğŸ’¾ è¨­å®šã‚’.txtã§ä¿å­˜</button>
    <button class="primary-btn" onclick="copyToClipboard()">ğŸ“‹ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼</button>
</div>

<div class="master-data">
    <h3>âš™ï¸ æŠ½é¸é …ç›®ã®ç·¨é›†</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <div>å±æ€§ï¼ˆç”·æ€§ï¼‰<textarea id="master-attr-male" oninput="updateMaster()">
            ã‚¯ãƒ¼ãƒ«
ãƒ„ãƒ³ãƒ‡ãƒ¬
ãƒ¤ãƒ³ãƒ‡ãƒ¬
ç†±è¡€
å…ƒæ°—
ã‚«ãƒªã‚¹ãƒ
ãŠãƒã‚«
ãƒ‰ã‚¸
ãƒ€ã‚¦ãƒŠãƒ¼ç³»
ãŠã£ã¨ã‚Š
éˆæ„Ÿ
ãƒ˜ã‚¿ãƒ¬
ç‹å­æ§˜
ãƒ‰S
ãƒ‰M
å¥æ°—
ãƒ”ãƒ¥ã‚¢
å¤©çœŸçˆ›æ¼«
ãŠèª¿å­è€…
å†·å¾¹
çœŸé¢ç›®
ä¸çœŸé¢ç›®
ä¸å™¨ç”¨
é™°ã‚­ãƒ£
é™½ã‚­ãƒ£
å¤©æ‰
å‡¡äºº
åŠªåŠ›å®¶
ãƒŠãƒ«ã‚·ã‚¹ãƒˆ
çŒ®èº«çš„
ãŠã‹ã‚“æ°—è³ª
çŠ¬ã£ã½ã„
çŒ«ã£ã½ã„
çˆ½ã‚„ã‹
ç™’ã—ç³»
ã‚¬ã‚µãƒ„
éŠã³äºº
ä¸å¹¸ä½“è³ª
ãƒŸã‚¹ãƒ†ãƒªã‚¢ã‚¹
å­¤é«˜
ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼
ç ´å¤©è’
å¤©ç„¶
å¤‰äºº
è‡ªç”±äºº
æ¯’èˆŒ
ç´ ç›´
æ­£ç¾©æ„ŸãŒå¼·ã„
è‡ªå·±çŠ ç‰²çš„
å„ªã—ã„
å¼·å¼•
æ„åœ°æ‚ª
å„šã’
ãƒ¡ãƒ³ãƒ˜ãƒ©
æƒ…ç†±çš„
ç©ã‚„ã‹
å®Œç’§ä¸»ç¾©
ç„¡æ°—åŠ›
è…¹é»’ã„
è£•ç¦
ãƒ­ãƒãƒ³ãƒã‚¹ãƒˆ
ã‚»ã‚¯ã‚·ãƒ¼
å¯æ„›ã„ç³»
ã‚ã–ã¨ã„
åˆ©å·±çš„
åæŠ—çš„
å …ç‰©
ãŠäººå¥½ã—
ã²ã­ãã‚Œ
æ¯’èˆŒ
ç„¡å£
ç„¡è¡¨æƒ…
çŸ­æ°—
å˜˜ã¤ã
ãƒã‚«æ­£ç›´
ãƒã‚¬ãƒ†ã‚£ãƒ–
ãƒã‚¸ãƒ†ã‚£ãƒ–
ã‚µã‚¤ã‚³ãƒ‘ã‚¹
äººæ°—è€…
ã¼ã£ã¡
å¤‰æ…‹
ã„ã˜ã‚‰ã‚Œã‚­ãƒ£ãƒ©
äººå«Œã„
äººé–“ä¸ä¿¡
ã‚·ãƒ£ã‚¤
è‡†ç—…
æ³£ãè™«
ç©ºæ°—ãŒèª­ã‚ãªã„
ä¸æ€è­°ã‚­ãƒ£ãƒ©
å‹æ°—
ç”Ÿæ„æ°—
èƒ½å¤©æ°—
é«˜é£›è»Š
ã‚ªã‚¿ã‚¯
å°‘å¥³è¶£å‘³
ã‚ªã‚«ãƒ«ãƒˆãƒãƒ‹ã‚¢
è‡ªå·±è‚¯å®šæ„Ÿä½ã„
ä¸æ†«
ä¿ºæ§˜
ãƒãƒ£ãƒ©ç”·
ã‚ªã‚«ãƒ
ã‚ªãƒ©ã‚ªãƒ©ç³»
ãƒ¯ã‚¤ãƒ«ãƒ‰
ä¸­æ€§çš„
        </textarea></div>
        <div>å±æ€§ï¼ˆå¥³æ€§ï¼‰<textarea id="master-attr-female" oninput="updateMaster()">æ¸…æ¥š&#13;ãƒ„ãƒ³ãƒ‡ãƒ¬&#13;ãŠå§‰æ§˜&#13;å‹æ°—</textarea></div>
        <div>å±æ€§ï¼ˆä¸­æ€§ï¼‰<textarea id="master-attr-neu" oninput="updateMaster()">ãƒŸã‚¹ãƒ†ãƒªã‚¢ã‚¹&#13;ä¸­æ€§çš„&#13;ç„¡å¢&#13;é”è¦³</textarea></div>
        <div>è‚©æ›¸ã<textarea id="master-title" oninput="updateMaster()">å­¦ç”Ÿ&#13;æ¢åµ&#13;ä½œå®¶&#13;åº—å“¡</textarea></div>
        <div>ç›¸æ‰‹ã¸ã®æƒ³ã„<textarea id="master-feel" oninput="updateMaster()">ç‰‡æƒ³ã„&#13;ä¿¡é ¼&#13;åŸ·ç€&#13;æ†§ã‚Œ</textarea></div>
        <div>æ·±æ˜ã‚Šè³ªå•<textarea id="master-deep" oninput="updateMaster()">å¼±ç‚¹ã¯ï¼Ÿ&#13;å¥½ããªéƒ¨ä½ã¯ï¼Ÿ</textarea></div>
        <div>å‡ºæ¥äº‹<textarea id="master-event" oninput="updateMaster()">å¶ç„¶ã®å†ä¼š&#13;é›¨ã®æ—¥ã®äº‹ä»¶</textarea></div>
    </div>
</div>

<script>
const storeKeyMaster = "cp_game_master_v6";
let masterData = {};

function adjustHeight(el) {
    if (el.closest('.master-data')) return;
    el.style.height = 'auto';
    el.style.height = el.scrollHeight + 'px';
}

document.addEventListener('input', e => {
    if (e.target.tagName.toLowerCase() === 'textarea') adjustHeight(e.target);
});

window.onload = () => {
    const savedMaster = localStorage.getItem(storeKeyMaster);
    if (savedMaster) {
        masterData = JSON.parse(savedMaster);
        document.getElementById('master-attr-male').value = masterData.attrMale.join('\n');
        document.getElementById('master-attr-female').value = masterData.attrFemale.join('\n');
        document.getElementById('master-attr-neu').value = masterData.attrNeu.join('\n');
        document.getElementById('master-title').value = masterData.title.join('\n');
        document.getElementById('master-feel').value = masterData.feel.join('\n');
        document.getElementById('master-deep').value = masterData.deep.join('\n');
        document.getElementById('master-event').value = masterData.event.join('\n');
    } else {
        updateMaster();
    }
};

function updateMaster() {
    masterData = {
        attrMale: document.getElementById('master-attr-male').value.split('\n').filter(v => v),
        attrFemale: document.getElementById('master-attr-female').value.split('\n').filter(v => v),
        attrNeu: document.getElementById('master-attr-neu').value.split('\n').filter(v => v),
        title: document.getElementById('master-title').value.split('\n').filter(v => v),
        feel: document.getElementById('master-feel').value.split('\n').filter(v => v),
        deep: document.getElementById('master-deep').value.split('\n').filter(v => v),
        event: document.getElementById('master-event').value.split('\n').filter(v => v)
    };
    localStorage.setItem(storeKeyMaster, JSON.stringify(masterData));
}

function slot(id, list) {
    const el = document.getElementById(id);
    let count = 0;
    const interval = setInterval(() => {
        el.textContent = list[Math.floor(Math.random() * list.length)];
        count++;
        if (count > 12) clearInterval(interval);
    }, 40);
}

function rollGenderAttr(num) {
    const gender = document.getElementById(`gender${num}`).value;
    let list;
    if (gender === 'ç”·æ€§') list = masterData.attrMale;
    else if (gender === 'å¥³æ€§') list = masterData.attrFemale;
    else list = masterData.attrNeu;
    slot(`attr${num}`, list);
}

function rollAll() {
    rollGenderAttr(1); slot('title1', masterData.title); slot('feel1', masterData.feel);
    rollGenderAttr(2); slot('title2', masterData.title); slot('feel2', masterData.feel);
}

function addExtra(type) {
    const container = document.getElementById(`${type}-container`);
    const list = masterData[type];
    if (!list.length) return;
    const text = list[Math.floor(Math.random() * list.length)];
    const div = document.createElement('div');
    div.className = 'item-box';
    div.innerHTML = `
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
            <strong style="font-size:18px;">${text}</strong>
            <button class="roll-btn" style="color:var(--muted); border:none;" onclick="this.parentElement.parentElement.remove()">âœ• å‰Šé™¤</button>
        </div>
        <textarea class="save-target auto-resize" data-label="${type === 'deep' ? 'è³ªå•' : 'å‡ºæ¥äº‹'}: ${text}"></textarea>
    `;
    container.appendChild(div);
    const ta = div.querySelector('textarea');
    adjustHeight(ta);
}

function buildExportText() {
    let txt = "ã€ãƒ©ãƒ³ãƒ€ãƒ ã‚«ãƒ—è¨­å®šã€‘\n\n";
    for(let i=1; i<=2; i++){
        const g = document.getElementById(`gender${i}`).value;
        const a = document.getElementById(`attr${i}`).textContent;
        const t = document.getElementById(`title${i}`).textContent;
        const f = document.getElementById(`feel${i}`).textContent;
        if(a !== "-") txt += `CHARACTER ${i}: [${g}] ${a} / ${t} / ç›¸æ‰‹ã¸ã®æƒ³ã„: ${f}\n`;
    }
    txt += "\n";

    document.querySelectorAll('.save-target').forEach(el => {
        const label = el.getAttribute('data-label');
        const val = el.value.trim();
        if (val) txt += `â–  ${label}\n${val}\n\n`;
    });
    return txt.trim();
}

function saveText() {
    const txt = buildExportText();
    const blob = new Blob([txt], {type: "text/plain"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `cp_setting.txt`;
    a.click();
}

function copyToClipboard() {
    const txt = buildExportText();
    navigator.clipboard.writeText(txt).then(() => alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"));
}
</script>

</body>
</html>
